@model IEnumerable<VeggieRestaurantApp.Models.Diner>

@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<div>
    <h1 class="display-3">Welcome Plant Based Foodies</h1>
    <p class="lead">
        We simplify the search for plant based dining in your local area. We provide information on restaurants that cater to plant based diners.<br>
        No more boring side salads and veggie burgers for you!
    </p>
</div>
<div>
    <h1> Dining In? </h1>
</div>
<div>
    <div class="form-group">
        <label class="col-form-label col-form-label-lg" for="inputLarge">Search for a recipe!</label>
        <input class="form-control form-control-lg" type="text" placeholder="Search Recipe" id="inputLarge">
        <button type="Submit" class="btn btn-primary" id="Search">Search</button>
    </div>
</div>
<table id="recipeTable" class="table table-hover">
    <thead>
        <tr id="recipeTable" class="table-success">
            <th scope="row">Recipe Name</th>
            <th scope="row">Recipe URL</th>
            <th scope="row">Health Labels</th>
            <th scope="row">Recipe Image</th>
        </tr>
    </thead>
    <tbody>
        <tr class="table-active"></tr>
        <tr scope="row"> </tr>
    </tbody>
</table>
<div> <h1>Dining Out?</h1></div>


<script>
    let searchButton = document.getElementById('Search');
    searchButton.addEventListener("click", () => {
        console.log("Button pressed")
        
        sendApiRequest()
    })

    async function sendApiRequest() {
        let APP_ID = "27dc2445"
        let API_KEY = "eef31258535ef241d8d42137edaceddf"
        var input = document.getElementById("inputLarge")
        const response = await fetch(`https://api.edamam.com/search?app_id=${APP_ID}&app_key=${API_KEY}&q=${input.value}&from=0&to=5&health=vegetarian`)
        console.log(response)
        let data = await response.json()
        console.log(data)
        useApiData(data)
    }

    function useApiData(data) {
        let content = document.getElementById("content");
        console.log(data);
        $("#recipeTable").append(
            `<tr>
                        <td>${data.hits[].recipe.label}</td>
                        <td><a href = ${data.hits[].recipe.url}>${data.hits[0].recipe.url}</a></td>
                        <td>${data.hits[].recipe.healthLabels}</td>
                        <td> <img src= ${data.hits[].recipe.image} alt=" recipe image" width: "auto" height= "100 px"></td>
            </tr>`
           
        )
    };
</script>
